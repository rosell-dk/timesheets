!function(d,e,k){var l=function(a,b){this.element=d(a);this.autoHide=!1!==b.autoHide&&!1!==this.element.data("datepicker-autohide");this.format=b.format||this.element.data("datepicker-format")||e.localeData().longDateFormat("L");this.calendarPlacement=b.calendarPlacement||this.element.data("datepicker-calendarplacement")||"right";this.picker=d(g.template).appendTo(b.container).on({click:d.proxy(this.click,this),mousedown:d.proxy(this.mousedown,this)});this.$viewport=d(b.viewport||b.container);var c=
b.startDate||this.element.data("datepicker-startdate")||k;this.startDate=c?g.parseDate(c,this.format):k;this.endDate=(c=b.endDate||this.element.data("datepicker-enddate")||k)?g.parseDate(c,this.format):k;this.isInput=this.element.is("input");this.component=!this.isInput&&this.element.is(".date")?this.element.find(".input-group-addon, .add-on"):!1;if(this.isInput)this.element.on({focus:d.proxy(this.show,this),blur:d.proxy(function(a){this._hide();this.triggerChangeDate()},this),input:d.proxy(function(a){this.updateFromValue(!0)},
this),keyup:d.proxy(function(a){13==a.keyCode&&this.updateFromValue()},this),click:d.proxy(this.show,this)});else if(this.component)this.component.on("click",d.proxy(this.show,this));else this.element.on("click",d.proxy(this.show,this));this.minViewMode=b.minViewMode||this.element.data("datepicker-minviewmode")||0;if("string"===typeof this.minViewMode)switch(this.minViewMode){case "months":this.minViewMode=1;break;case "years":this.minViewMode=2;break;default:this.minViewMode=0}this.viewMode=b.viewMode||
this.element.data("datepicker-viewmode")||0;if("string"===typeof this.viewMode)switch(this.viewMode){case "months":this.viewMode=1;break;case "years":this.viewMode=2;break;default:this.viewMode=0}this.startViewMode=this.viewMode;this.weekStart=b.weekStart||this.element.data("datepicker-weekstart")||0;this.weekEnd=0===this.weekStart?6:this.weekStart-1;this.fillDow();this.fillMonths();this.setCustomClasses();this.updateFromValue();this.showMode();this.refresh()};l.prototype={constructor:l,get:function(){return this.moment&&
this.moment.clone()},getAsText:function(a){var b=this.format;"[object Array]"===Object.prototype.toString.call(b)&&(b=b[0]);return this.moment&&this.moment.format(a||b)||""},show:function(a){if(!(this.isInput&&this.element.is(":disabled")||this.element.children("input").is(":disabled"))){this.picker.show();this.height=this.component&&this.component.outerHeight()||this.element.outerHeight();this.place();d(window).on("resize",d.proxy(this.place,this));a&&(a.stopPropagation(),a.preventDefault());if(!this.isInput)d(document).on("mousedown",
d.proxy(this.hide,this));this.element.trigger({type:"show"})}},_hide:function(a){if(0<navigator.userAgent.indexOf("MSIE 8.0")){var b=function(){clearTimeout(e);a.target.focus();c.picker.off("click",b)},c=this,d=arguments;this.picker.on("click",b);var e=setTimeout(function(){c.hide.apply(c,d);c.picker.off("click",b)},100)}else return this.hide.apply(this,arguments)},hide:function(){this.picker.hide();d(window).off("resize",this.place);this.viewMode=this.startViewMode;this.showMode();this.isInput||
d(document).off("mousedown",this.hide);this.refresh();this.element.trigger({type:"hide"})},refresh:function(){var a=this.getAsText();this.isInput?this.element.prop("value",a).change():(this.component&&this.element.find("input").prop("value",a).change(),this.element.data("date",a).change())},set:function(a,b){this.update(a,b);this.refresh()},place:function(){var a=this.component?this.component:this.element,b=a.offset(),c=this.$viewport.offset(),e=this.$viewport.scrollTop(),g=parseInt(this.element.parents().filter(function(){var a=
d(this).css("z-index");return"auto"!=a&&"0"!=a}).first().css("z-index"))+10;"left"==this.calendarPlacement?this.picker.css({top:b.top+this.height+e-c.top,left:b.left+a[0].offsetWidth-this.picker[0].offsetWidth}):this.picker.css({top:b.top+this.height+e-c.top,left:b.left,zIndex:g})},lastValue:null,triggerChangeDate:function(){var a=this.moment?this.moment.valueOf():null;a!=this.lastValue&&(this.lastValue=a,this.element.trigger({type:"changeDate"}));this.autoHide&&this.hide()},updateFromValue:function(a){this.update(this.isInput?
this.element.prop("value"):this.element.data("date"),a)},update:function(a,b){var c=this.moment?this.moment.valueOf():null,d=(this.moment=g.parseDate(a,this.format))?this.moment.valueOf():null;this.viewDate&&c==d||(this.viewDate=this.get()||e().hours(0).minutes(0).seconds(0).milliseconds(0),this.fill(),this.element.trigger({type:"changeDateInstant"}));b||this.triggerChangeDate()},fillDow:function(){for(var a=this.weekStart,b="<tr>",c=d.proxy(e.localeData().weekdaysMin,e.localeData());a<this.weekStart+
7;)b+='<th class="dow">'+c(e().day(a++%7))+"</th>";b+="</tr>";this.picker.find(".datepicker-days thead").append(b)},fillMonths:function(){for(var a="",b=0,c=d.proxy(e.localeData().monthsShort,e.localeData());12>b;)a+='<span class="month">'+c(e().startOf("month").month(b++))+"</span>";this.picker.find(".datepicker-months td").append(a)},fill:function(){var a=this.viewDate.year(),b=this.viewDate.month(),c=this.get(),d=c?c.valueOf():null,g=c?c.year():null,c=c?c.month():null;this.picker.find(".datepicker-days th:eq(1)").text(e.localeData().months(e().month(b))+
" "+a);var f=e([a,b,1]);f.subtract(1,"day");f.day(f.day()-(f.day()-this.weekStart+7)%7);var k=e(f).add(42,"days").valueOf();html=[];for(var h;f.valueOf()<k;){f.day()===this.weekStart&&html.push("<tr>");h="";if(f.year()<a||f.year()==a&&f.month()<b)h+=" old";else if(f.year()>a||f.year()==a&&f.month()>b)h+=" new";f.valueOf()===d&&(h+=" active");if(f.valueOf()<this.startDate||f.valueOf()>this.endDate)h+=" disabled";html.push('<td class="day'+h+'">'+f.date()+"</td>");f.day()===this.weekEnd&&html.push("</tr>");
f.add(1,"days")}this.picker.find(".datepicker-days tbody").empty().append(html.join(""));b=this.picker.find(".datepicker-months").find("th:eq(1)").text(a).end().find("span").removeClass("active").removeClass("disabled");g===a&&b.eq(c).addClass("active");(this.startDate&&a<this.startDate.year()||this.endDate&&a>this.endDate.year())&&b.addClass("disabled");this.startDate&&a==this.startDate.year()&&b.slice(0,this.startDate.month()).addClass("disabled");this.endDate&&a==this.endDate.year()&&b.slice(this.endDate.month()+
1).addClass("disabled");html="";a=10*parseInt(a/10,10);b=this.picker.find(".datepicker-years").find("th:eq(1)").text(a+"-"+(a+9)).end().find("td");--a;for(d=-1;11>d;d++)html+='<span class="year'+(-1===d||10===d?" old":"")+(g===a?" active":"")+(this.startDate&&a<this.startDate.year()||this.endDate&&a>this.endDate.year()?" disabled":"")+'">'+a+"</span>",a+=1;b.html(html)},click:function(a){a.stopPropagation();a.preventDefault();var b=d(a.target).closest("span, td, th");if(1===b.length)switch(b[0].nodeName.toLowerCase()){case "th":switch(b[0].className){case "switch":this.showMode(1);
break;case "prev":case "next":a=g.modes[this.viewMode],this.viewDate.add(a.navStep*("prev"===b[0].className?-1:1),a.navFnc),this.fill(),this.refresh()}break;case "span":if(!b.is(".disabled")){if(b.is(".month"))a=b.parent().find("span").index(b),this.viewDate.add(a-this.viewDate.month(),"months");else{var c=parseInt(b.text(),10)||0;this.viewDate.year(c)}this.viewMode!==this.minViewMode?(this.showMode(-1),this.set(this.viewDate,!0)):this.set(this.viewDate)}break;case "td":!b.is(".disabled")&&b.is(".day")&&
(a=parseInt(b.text(),10)||1,c=this.viewDate.clone(),b.is(".old")?c.startOf("month").add(-1,"days"):b.is(".new")&&c.endOf("month").add(1,"days"),b=c.month(),c=c.year(),this.set(e([c,b,a])))}},dateWithinRange:function(a){return a>=this.startDate&&a<=this.endDate},mousedown:function(a){a.stopPropagation();a.preventDefault()},showMode:function(a){a&&(this.viewMode=Math.max(this.minViewMode,Math.min(2,this.viewMode+a)));this.picker.find(">div").hide().filter(".datepicker-"+g.modes[this.viewMode].clsName).show()},
setCustomClasses:function(){"left"==this.calendarPlacement&&this.picker.addClass("datepicker-left")}};d.fn.mdatepicker=function(a,b){var c=[],e=this.each(function(){var e=d(this),f=e.data("datepicker"),g="object"===typeof a&&a;"string"===typeof a?f&&(e=f[a](b),"undefined"!==typeof e&&c.push(e)):f||e.data("datepicker",new l(this,d.extend({},d.fn.mdatepicker.defaults,g)))});return 1==c.length?c[0]:c.length?c:e};d.fn.mdatepicker.defaults={container:"body"};d.fn.mdatepicker.Constructor=l;var g={modes:[{clsName:"days",
navFnc:"months",navStep:1},{clsName:"months",navFnc:"years",navStep:1},{clsName:"years",navFnc:"years",navStep:10}],parseDate:function(a,b){var c=null;"string"===typeof a&&(c="[object Array]"===Object.prototype.toString.call(b)?e(a,b,!0):e(a,b));c&&c.isValid()||(c=e(a));return c&&c.isValid()?c.hours(0).minutes(0).seconds(0).milliseconds(0):null},headTemplate:'<thead><tr><th class="prev">&lsaquo;</th><th colspan="5" class="switch"></th><th class="next">&rsaquo;</th></tr></thead>',contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>'};
g.template='<div class="datepicker dropdown-menu"><div class="datepicker-days"><table class=" table-condensed">'+g.headTemplate+'<tbody></tbody></table></div><div class="datepicker-months"><table class="table-condensed">'+g.headTemplate+g.contTemplate+'</table></div><div class="datepicker-years"><table class="table-condensed">'+g.headTemplate+g.contTemplate+"</table></div></div>"}(this.jQuery,this.moment);
